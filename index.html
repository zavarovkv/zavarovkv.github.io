<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<title>Документация по партнерскому API Goods</title>
	</head>
<body>
<h1>Документация по партнерскому API Goods</h1>

<blockquote>
<p>Документ содержит описание Partner API.</p>
</blockquote>

<p><code>Partner API</code> предназначен для взаимодействия с Goods со стороны сторонних сервисов. API служит для управления заказами, оформленными покупателями на сайте goods.ru. </p>

<p>Документ предназначен для разработчиков приложений, взаимодействующих с партнерским интерфейсом Goods. В документе приведены примеры запросов и ответов с демонстрационными данными.</p>

<ol>
	<li><a href="#how_to_be_goods">Как работает маркетплейс Goods</a>

		<ul>
			<li><a href="#terminology">Терминология</a></li>
			<li><a href="#integration">Взаимодействие продавцов с Goods </a></li>
		</ul></li>
	<li><a href="#how_to_connect">Как подключиться к API</a></li>
	<li><a href="#api">Описание API</a>

		<ul>
			<li><a href="api_rules">Правила работы с API</a></li>
			<li><a href="#methods">Справочник методов</a></li>
		</ul></li>
	<li><a href="#price-list">Загрузка прайс-листа</a>

		<ul>
			<li><a href="#yml">Формат YML</a></li>
		</ul></li>
	<li><a href="#faq">Вопросы и ответы</a></li>
</ol>

<hr />

<a name="how_to_be_goods"></a>
<h2>Как работает маркетплейс Goods</h2>

<p>Для более глубокого понимания процесса интеграции рекомендуется ознакомиться с основной терминологией.</p>

<a name="terminology"></a>
<h3>Терминология</h3>

<ul>
	<li><strong>Маркетплейс </strong> — интернет-сайт (мобильное приложение) Goods, где размещены <em>Офферы</em> <em>Продавцов</em> на <em>Товары</em>, которые может приобрести <em>Покупатель</em>. Суть <em>Маркетплейса</em> заключается в том, что на один <em>Товар</em> размещается несколько <em>Офферов</em> от разных <em>Продавцов</em>, тем самым создается рыночная ситуация, когда Покупатель может выбрать <em>Оффер</em> на <em>Товар</em> по лучшей цене.</li>
	<li><strong>Продавец</strong> — контрагент, который торгует товарами на <em>Маркетплейсе</em>.</li>
	<li><strong>Оффер</strong> — торговое предложение <em>Продавца</em> на <em>Маркетплейсе</em> о продаже конкретного <em>Товара</em> по определенной цене из определенного <em>Стока</em>.</li>
	<li><strong>Сток</strong> — множество всех экземпляров <em>Товара</em> на торговом объекте <em>Продавца</em>, доступных к продаже в рамках определенного <em>Оффера</em>.</li>
	<li><strong>Заказ</strong> — сделка купли-продажи, оформленная <em>Покупателем</em> на <em>Маркетплейсе</em> и состоящая из нескольких <em>Доставок</em>.</li>
	<li><strong>Доставка</strong> — набор <em>Отправлений</em>, перемещаемых с сортировочного центра <em>Маркетплейса</em> до <em>Покупателя</em> с целью исполнения <em>Заказа</em>.</li>
	<li><strong>Отправление</strong> — набор <em>Грузовых мест</em>, перемещаемых с торгового объекта <em>Продавца</em> на сортировочный центр <em>Маркетплейса</em> с целью исполнения <em>Доставки</em>.</li>
	<li><strong>Грузовое место</strong> — материальный объект, перемещаемый в логистической цепочке исполнения <em>Отправления</em>, содержащий <em>Лоты</em> упакованные должным образом.</li>
	<li><strong>Лот</strong> — один экземпляр <em>Товара</em>, который <em>Покупатель</em> приобрел на <em>Маркетплейсе</em> на основании определенного <em>Оффера</em>; это базовая единица для биллинга, начисления баллов, скидок, частичных отказов, возвратов и пр.; <em>Лот</em> может занимать одно или несколько <em>Грузовых мест</em>, а также входить в <em>Грузовое место</em> с другими <em>Лотами</em>. <em>Лот</em> всегда соответствует одному экземпляру <em>Товара</em>.</li>
</ul>

<a name="integration"></a>
<h3>Взаимодействие продавцов с Goods</h3>

<ol>
	<li><em>Продавец</em> подписывает договор об оказании услуг, после чего размещает товарные предложения на сайте Goods. Управление товарными предложениями осуществляется через прайс-лист в формате YML (<a href="https://yandex.ru/support/partnermarket/export/yml.html">подробнее про YML</a>). 

		<p>Товарные предложения описываются характеристиками:</p>

		<ul>
			<li>товар;</li>
			<li>цена;</li>
			<li>доступные к продаже остатки (кол-во);</li>
			<li>склад на котором находится товар.</li>
		</ul>

		<h4>Пример описания товарных предложений в прайс-листе</h4>

		<script src="https://gist.github.com/zavarovkv/7eb65b1b4014e7de8e0f4fa9d785811d.js"></script></li>
	<li><em>Покупатель</em> оформил заказ<em> на </em>маркетплейсе<em> Goods.ru. Предположим, заказ состоит из трех позиций: 
		</em>

		<ul>
			<li><em>телефон</em> </li>
			<li><em>планшет</em></li>
			<li> <em>корм для питомца</em></li>
		</ul>

		<p><em>Телефон</em> и <em>планшет</em> куплен у <em>Продавец 1</em>, а <em>корм для питомца</em> у <em>Продавец 2</em>. Goods сообщает каждому из продавцов про свою часть заказа.</p>

		<figure><img src="img-1.jpg"/></figure></li>
	<li>Для упрощения рассмотрим взаимодействие Goods только с одним из продавцом.

		<p>Продавец, получив новое отправление от Goods проверяет доступное кол-во остатков по каждой из позиции в отправлении и дает свое согласие об отгрузке отправления в указанный срок.</p>

		<figure><img src="img-2.jpg"/></figure></li>
	<li>Продавец комплектует товары по грузовым местам. Каждому грузовому месту присваивается и распечатывается маркировочный лист с уникальным Штрих-кодом. Продавец сообщает в Goods об успешной комплектации отправления для того, чтобы Goods смог передать о Штрих-кодах на Сортировочный Центр.

		<figure><img src="img-3.jpg"/></figure></li>
	<li></li>
</ol>

<hr />

<a name="how_to_connect"></a>
<h2>Как подключиться к API</h2>

<p>Для использования API продавец должен выполнить шаги</p>

<ol>
	<li>Зарегистрироваться в Goods и получить доступ к Личному Кабинету.</li>
	<li>Настроить интеграцию по API в Личном Кабинете.</li>
	<li>Получите авторизационный токен в Личном Кабинете.</li>
	<li>Получите идентификатор магазина (у менеджеров goods).</li>
	<li>Используйте токен и идентификатор для запросов через API.</li>
</ol>

<hr />

<a name="api"></a>
<h2>Описание API</h2>

<p>API предназначено для взаимодействия Goods с системой учета заказов на стороне продавцов.</p>

<a name="api_rules"></a>
<h3>Правила работы с API</h3>

<h4>Схема</h4>

<p>При работе с API рекомендуется использовать <code>версию v2</code>. Предыдущие версии API сохранены для совместимости и не рекомендуются к использованию. Запросы необходимо отправлять по адресу:</p>

<pre><code>https://partner.goods.ru/api/market/{version}/orderService/
</code></pre>

<p>Все запросы принимаются только по <code>https</code> в кодировке <code>UTF-8</code> в виде <code>POST</code>-запросов. Ответ формируется в <code>JSON</code>-формате.</p>

<p>Данные типа «Дата» указываются в формате <code>Y-m-d</code> (например <code>2014-03-21</code>), данные типа «Дата/время» — в формате <code>Y-m-d H:i:s</code> (например <code>2014-03-21 05:14:07</code>).</p>

<h4>Авторизация</h4>

<p>Авторизация производится с помощью <code>API-токена</code>, который передается в параметре POST-запроса — <code>token</code>. API-токен необходимо передавать при каждом обращении. Пример исходящих данных для метода <code>POST /order/get</code> (получение подробной информации по заказам):</p>

<script src="https://gist.github.com/zavarovkv/0b963875f8b4bb30a99d8a359b2833e7.js"></script>
<h4>Сообщения об ошибках</h4>

<p>При обращении к API могут допускаться ошибки, о чем система будет сообщать. В параметре <code>success</code> будет возвращено значение <code>0</code>. Элемент <code>error</code> будет содержать подробную информацию об ошибке.</p>

<p><strong>Важно:</strong> и в случае успешного выполнения запроса, и в случае ошибочно сформированного запроса, сервер вернет статус <code>200 OK</code>.</p>

<script src="https://gist.github.com/zavarovkv/a32a04e5280b08cf3013245b930efb88.js"></script>
<a name="methods"></a>
<h3>Справочник методов</h3>

<ul>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/new</mark></a> — создание заказа</li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/confirm</mark></a> — подтверждение заказа</li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/packing</mark></a> — комплектация заказа</li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/shipping</mark></a> — отгрузка заказа</li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/cancel</mark></a> — отмена заказа <strong>покупателем</strong></li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/reject</mark></a> — отмена заказа <strong>продавцом</strong></li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/labelUpdate</mark></a> — изменение маркировочного листа</li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/search</mark></a> — получение списка заказов, удовлетворяющих заданному фильтру</li>
	<li><a href="#api_order_new"><mark><strong>POST</strong> /order/get</mark></a> — получение детальной информации по заказу</li>
</ul>

<hr />

<h4><mark><strong>POST</strong> /order/new</mark> - создание заказа</h4>

<a name="api_order_new"></a>
<p><strong>Метод вызывается Goods</strong> после оформления нового заказа покупателем на сайте. Предназначен для передачи созданного заказа в систему обработки заказов продавца.</p>

<p>Информация передаваемая продавцу по заказу включает:</p>

<ul>
	<li>детальную информацию по каждой позиции в заказе;</li>
	<li>информацию для печати маркировочного листа (<a href="#label_info">подробнее о маркировочном листе</a>);</li>
	<li>максимально возможный срок отгрузки заказа.</li>
</ul>

<h5>Параметры</h5>

<table class="table table-bordered">
	<thead>
		<tr>
			<th>Параметр</th>
			<th>Тип</th>
			<th>Пример</th>
			<th>Обязательность</th>
			<th>Описание</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><code>shipments</code></td>
			<td><code>массив</code></td>
			<td>[объект]</td>
			<td>обязательный</td>
			<td>Список заказов</td>
		</tr>
 		<tr>
 			<td> - <code>shipmentId</code></td>
 			<td><code>строка</code></td>
 			<td>"81234567890"</td>
 			<td>обязательный</td>
 			<td>Уникальный идентификатор заказа Goods</td>
 		</tr>
 		<tr>
 			<td> - <code>shipmentDate</code></td>
 			<td><code>строка</code></td>
 			<td>"2017-07-26T15:48:00+03:00"</td>
 			<td>обязательный</td>
 			<td>Дата и время создания заказа</td>
 		</tr>
 		<tr>
 			<td> -- <code>items</code></td>
 			<td><code>массив</code></td>
 			<td>[объект]</td>
 			<td>обязательный</td>
 			<td>Список позиций в заказе</td>
 		</tr>
 		<tr>
 			<td> --- <code>itemIndex</code></td>
 			<td><code>строка</code></td>
 			<td>"1"</td>
 			<td>обязательный</td>
 			<td>Уникальный номер позиции в рамках заказа, нумерация начинается с 0</td>
 		</tr>
 		<tr>
 			<td> --- <code>offerId</code></td>
 			<td><code>строка</code></td>
 			<td>"456789"</td>
 			<td>обязательный</td>
 			<td>Идентификатор оффера (товарного предложения) продавца передаваемый в прайс-листе в параметре id элемента &lt;offer&gt;</td>
 		</tr>
 		<tr>
 			<td> --- <code>price</code></td>
 			<td><code>строка</code></td>
 			<td>"2500.0"</td>
 			<td>обязательный</td>
 			<td>Цена позиции из прайс-листа продавца</td>
 		</tr>
 		<tr>
 			<td> --- <code>finalProce</code></td>
 			<td><code>строка</code></td>
 			<td>"2250.0"</td>
 			<td>не обязательный</td>
 			<td>Цена позиции за вычетом всех скидок</td>
 		</tr>
 		<tr>
 			<td> --- <code>discounts</code></td>
 			<td><code>массив</code></td>
 			<td>[объект]</td>
 			<td>не обязательный</td>
 			<td>Список примененных скидок к текущей позиции</td>
 		</tr>
 		<tr>
 			<td> ---- <code>discountType</code></td>
 			<td><code>строка</code></td>
 			<td>"BPG"</td>
 			<td>не обязательный</td>
 			<td>Тип скидки. Возможные значения: <b>LOY</b> - Программа Лояльности (снижение цены на товар за счет бонусных рублей); <b>BPG</b> - Гарантия Лучшей Цены (снижение цены на товар до минимльной на рынке)</td>
 		</tr>
 		<tr>
 			<td> ---- <code>discountAmount</code></td>
 			<td><code>строка</code></td>
 			<td>"250.0"</td>
 			<td>не обязательный</td>
 			<td>Сумма скидки</td>
 		</tr>
 		<tr>
 			<td> -- <code>label</code></td>
 			<td><code>объект</code></td>
 			<td>объект</td>
 			<td>обязательный</td>
 			<td>Информация для печати <a href="#label_info">маркировочного листа</a></td>
 		</tr>
 		<tr>
 			<td> --- <code>deliveryId</code></td>
 			<td><code>строка</code></td>
 			<td>"987654321"</td>
 			<td>обязательный</td>
 			<td>Индентификатор доставки. Печатается на маркировочном листе</td>
 		</tr>
 		<tr>
 			<td> --- <code>region</code></td>
 			<td><code>строка</code></td>
 			<td>""</td>
 			<td>обязательный</td>
 			<td>Регион адреса получателя. Печатается на маркировочном листе</td>
 		</tr>
 		<tr>
 			<td> --- <code>city</code></td>
 			<td><code>строка</code></td>
 			<td>"Москва"</td>
 			<td>обязательный</td>
 			<td>Город адреса получателя. Печатается на маркировочном листе</td>
 		</tr>
 		<tr>
 			<td> --- <code>address</code></td>
 			<td><code>строка</code></td>
 			<td>"ул. Самокатная 6/2 кв. 53"</td>
 			<td>обязательный</td>
 			<td>Адрес получателя. Печатается на маркировочном листе</td>
 		</tr>
 		<tr>
 			<td> --- <code>buyerFullName</code></td>
 			<td><code>строка</code></td>
 			<td>"Заваров Константин Викторович"</td>
 			<td>обязательный</td>
 			<td>ФИО получателя. Печатается на маркировочном листе</td>
 		</tr>
 		<tr>
 			<td> --- <code>merchantId</code></td>
 			<td><code>строка</code></td>
 			<td>"7"</td>
 			<td>обязательный</td>
 			<td>Уникальный идентификатор продавца. Печатается на маркировочном листе</td>
 		</tr>
 		<tr>
 			<td> --- <code>merchantName</code></td>
 			<td><code>строка</code></td>
 			<td>"ООО М.Видео"</td>
 			<td>обязательный</td>
 			<td>Юр. наименование продавца. Печатается на маркировочном листе</td>
 		</tr>
 		<tr>
 			<td> --- <code>labelText</code></td>
 			<td><code>строка</code></td>
 			<td>"&lt;html&gt;...&lt;/html&gt;"</td>
 			<td>обязательный</td>
 			<td>Шаблон маркировочного листа в формате HTML</td>
 		</tr>
 		<tr>
 			<td> -- <code>shipping</code></td>
 			<td><code>объект</code></td>
 			<td>"объект"</td>
 			<td>обязательный</td>
 			<td>Дополнительная информация об отгрузке</td>
 		</tr>
 		<tr>
 			<td> -- <code>shippingDate</code></td>
 			<td><code>строка</code></td>
 			<td>"2017-07-26T15:48:00+03:00"</td>
 			<td>обязательный</td>
 			<td>Максимально возможный срок на отгрузку заказа продавцом. Если заказ НЕ будет отгружен до указанного срока, то он считается отмененным продавцом (взымается штрафная комиссия)</td>
 		</tr>
	</tbody>
</table>
<br>
<h5>Ответ</h5>

<p>Данные в ответе не ожидаются</p>

<h5>Пример запроса</h5>

<script src="https://gist.github.com/zavarovkv/ee84299728327ea4c4f2ee045e3c96bb.js"></script>
<h5>Пример ответа (ожидаемого от продавца)</h5>

<script src="https://gist.github.com/zavarovkv/b26c52b02244632207e6de237f41a9be.js"></script>
<a name="label_info"></a>
<h5>Подробнее о <strong>Маркировочном листе</strong></h5>

<hr />

<a name="faq"></a>
<h2>Вопросы и ответы</h2>

<ul>
	<li><strong>Будет ли вызван метод <em>order/cancel</em> при отмене покупателем всего заказа?</strong>

		<p>Да. Метод <em>order/cancel</em>&nbsp;будет вызван по каждой позиции в заказе.</p></li>
	<li><strong>Нужно ли вызывать метод <em>order/reject</em>, если закончились доступные остатки по каким-то позициям в заказе?</strong>

		<p>Да, метод <em>order/reject</em> необходимо вызывать во всех случаях, когда продавец хочет сообщить Goods, что не можете выполнить заказ. Например, если закончились доступные остатки.</p>

		<h2><a href="https://goo.gl/forms/aPaGzQ8Zb9G37wSM2">Я не нашел ответ на свой вопрос</a></h2></li>
</ul>

<hr />

<p>Редакция от 21.02.2018 12:12</p>

<p><a href="#print">Печать</a> ∙&nbsp;<a href="https://github.com/zavarovkv/zavarovkv.github.io">Править на github</a> ∙&nbsp;<a href="https://goo.gl/forms/aPaGzQ8Zb9G37wSM2">Задать вопрос</a></p>

</body>
</html>

